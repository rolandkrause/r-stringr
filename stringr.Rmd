---
title: "String manipulation"
subtitle: "using stringr"
author: "Emma Schymanski"
date: "10 Oct. 2022"
done: true
---

```{r setup-practical, child = '_setup_practical.Rmd'}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

> This little tutorial aims to make you familiar with some of the functions of the `stringr` package and a few regular expressions. 

```{r, echo = FALSE}
htmltools::img(src = "https://raw.githubusercontent.com/rstudio/hex-stickers/999a52ccc6b53d8a620a5f930e4f9e68492d346d/PNG/stringr.png",
               style = "float:right;height:100px;")
```


## Strings and escape sequences in R

##### Write a sentence with escape sequences.
Try the sentence: `"It's the end of the world!" he said.\` . 
Assign the string to a variable and try as`print()`, `cat()` and `writeLines()`.

```{r, solution = TRUE}
my_string <- '"It\'s the end of the world!" he said.\\'
print(my_string)
cat(my_string)
writeLines(my_string)
```

## `stringr` functions 

We will be using the `words` data that is built into `stringr`. 
The data set is available to you if you load the package.

```{r}
length(words)
```


##### Select words that contain a `y`

```{r, solution = TRUE}
str_subset(words, "y")

```

##### Retrieve a boolean vector that indicates which words start with `y`


```{r, solution = TRUE}
str_detect(words, "^y")
```

##### Retrieve the indices for all words containing `ch` within the word. 

`ch` must not be present at the start or the end of the word. 

```{r, solution = TRUE}
str_which(words, ".ch.")
```

##### Extract the `y` and the previous character.

Note: Use the function `unique()` around the results to avoid printing many empty matches.

```{r, solution = TRUE}
str_extract(words, ".y") %>% unique()
```


##### Get the length of the first ten words

You can use `head(words, 10)` as a convenient way to access the elements of the `words` vector.
```{r, solution = TRUE}
str_length(head(words, 10))
```


## Viral research 

Read the genome sequence of the Hepatitis D virus: [hepd.fasta](https://biostat2.uni.lu/practicals/data/hepd.fasta).
For now, just execute the following:

```{r}
hepd <- readr::read_lines("https://biostat2.uni.lu/practicals/data/hepd.fasta")
```

##### What is the length of the genome sequence?

```{r, solution = TRUE}
str_length(hepd)
```

##### What is the sequence composition? How often does each character occur?

```{r, solution = TRUE}
str_count(hepd, c("A", "C", "G","T"))
```


##### Find motifs in the sequence using `str_locate()`. 

Find all matches of the sequence $ATG$ in the sequence. 

```{r, solution = TRUE}
str_locate_all(hepd, "ATG")
```


